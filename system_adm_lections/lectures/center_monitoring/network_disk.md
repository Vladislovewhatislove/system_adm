# Работа с сетевыми дисками

## Сетевые диски в сетях Microsoft

При использовании **MS AD** для централизованной авторизации и аутентификации создаётся один или несколько сетевых дисков для хранения информации. 
У централизованного хранения данных есть *два преимущества*:
- Во первых, это увеличивает надёжность за счёт **резервного копирования**.
- Во вторых, данные пользователя не привязаны к рабочей станции, что позволяет работать на любом ПК и при необходимости быстро провести замену. 
**Сетевые диски** можно использовать для *хранения профиля пользователя*, что позволяет *переносить настройки с одной рабочей машины на другую*. 
Но они занимают несколько **сотен мегабайт**, для быстрого копирования на ПК *потребуется сеть* **1Гб/с**

Для *обмена данными с сервером* применяется протокол **SMB** (**CIFS**). 
Изначально протокол **SMB** *работал поверх сетей* **IPX/SPX** с использованием **NetBIOS**. 
В Windows **2000** произошёл переход на сети **TCP/IP**, но многие механизмы **NetBIOS** остались на месте. 
В версии **2.0**, появившейся в *2006 году* произошёл окончательный переход на **TCP/IP** ,что увеличело скорости работы. 
В **2012** году вышла версия протокола **3.0**, расширяющая его возможности
*Разные версии* могут иметь системы с разной *версией протокола*.

## Создание сетевых дисков в Windows Server 2012r2
Все компоненты для работы сетевых дисков устанавливаются в **Windows Server** вместе с операционной системой. 

Для создания сетевых дисков можно воспользоваться *двумя путями*:
- использование *контекстного меню на имени папки*
- использование **Server Manager**

В обоих случаях нужно заранее определиться, какой **каталог файловой системы** *будет* экспортирвоаться как общий по сети и как он будет **виден**. 
Необходимо помнить, что в случае *использования* **сетевых дисков** отдельно существуют **права доступа** к сетевому диску и **доступа** к *объектам файловой системы*. 

При использовании контекстного меню необходимо *найти* **папку**, которую хочется *превратить* в **сетевой диск**, щёлкнуть на неё правой кнопкой мыши, выбираем пункт "**свойства**" (**properties**). 
В одной из вкладок будет доступен пункт "**сделать общими**" (**Share**). 
Есть два варианта настройки: 
- *простой* ,предопределенные шаблоны прав доступа
- *расширенный*, позволяющий поменять **права** и выбрать **имя сетевого ресурса**. 
При названии, на символ "**$**" будет доступен при прямом обращении по имени. 
Для доступа к сетевому ресурсу его имя указывается как **\\server.fqdn\share_name**. 
Указанную строку можно просто ввести в адресной строке или использовать в скриптах.

При использовании **Server Manager** в левой панели должен быть пункт **File and storage services**.
При выборе указанного пункта появляется список **всех сетевых дисков**, настроенных на данном **ПК**. 
В правом верхнем углу будет доступно меню "**Tasks**", содержащее пункт "**New Share...**", запускающий **мастер создания сетевых папок**.

При указании прав доступа можно использовать как *имена конкретных пользователей*, так и *группы*. 
*Использование групп* удобно для распределения **прав**, но реализуется не всегда.
При настройке **прав** следует помнить, что при использовании **MS AD** на всех компьютерах домена *общая база пользователей и групп*. 
Для авторизации в любой доменной системе используется учётная запись. 

Оба рассматриваемых способа *позволяют создать* **сетевой диск** и выделить **права доступа к нему**. 
Для управлением правами доступа внутри сетевого диска понадобится **менять права на доступ** *к объектам файловой системы.* 
Так же можно создавать:
- квоты (ограничение максимального объёма файлов пользователей) 
- экраны (ограничения на сохраняемые файлы).

Чтобы их использовать понадобиться **File Server Resourse Manager**, который доставляется как компонент (**feature**) через оснастку **Server Manager**.

## Создание сетевых дисков с использованием протокола SMB в GNU/Linux
Для создания сетевых дисков в GNU/Linux можно использовать два протокола и две отдельные службы. 
Первая , выросших их Unix является - **NFS**. 
Его *редко используют* в системах, построенных на базе *MS AD*
Второй вариант для сетевых дисков - служба **samba**. 
В ней два компонента - сама **samba** и **winbind**, отвечающий за пространство имён и аутентификацию. 
Начиная с версии 4.1 поддерживает протокол **SMB 3.0**, с версии **4.3** - последнюю версию **SMB 3.1.1**.

К *особенностям* **samba** следует отнести *отсутствие графических интерфейсов*,а также *ручной настройкой конфигурационных файлов*
После настройки предоставляемые сетевые диски можно будет *настраивать* и *обслуживать* с клиентов **MS Windows**